<!DOCTYPE html>
<html>
	<head>
		<title>demonstration</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
	</head>
	<body>
		<h2>Test av bruttoviktstabell</h2>
		<form id="weightform">
			<select name="road">
	  			<option value="1">BK1</option> 
	  			<option value="2" selected>BK2</option>
	  			<option value="3">BK3</option>
			</select>
			<input type="text" placeholder="avstånd" name="distance" />
			<button type="submit" id="testweight" value="Kolla!">Kolla!</button>
			<p id='weightresult'></p>
		</form>

		<form id="axleform">
			<select name="road">
	  			<option value="1">BK1</option> 
	  			<option value="2" selected>BK2</option>
	  			<option value="3">BK3</option>
			</select>
			<select name="type">
	  			<option value="1">axel</option> 
	  			<option value="2" selected>boggie</option>
	  			<option value="3">trippelaxel</option>
			</select>
			<label><input type="checkbox" name="susp" value="susp">Bra fjädring</label>
			<label><input type="checkbox" name="prop" value="prop">Drivande</label>
			<input type="text" placeholder="avstånd" name="distance" />
			<button type="submit" id="testaxle" value="Kolla!">Kolla!</button>
			<p id='axleresult'></p>
		</form>

		<script type="text/javascript" src="../lib/lodash/lodash.js"></script>
		<script type="text/javascript" src="../lib/lodash/lodashmixins.js"></script>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="../js/rolast.js"></script>


		<script type="text/javascript">
			$("#weightform").submit(function(e){
				e.preventDefault();
				var form = $(this).serializeArray(),
					data = {road:+form[0].value,totalAxleDistance:+form[1].value.replace(/\,/,".")},
					list = rolast.lists.weightLimits,
					result = rolast.lookUpInList(list,data);
				console.log(data,result);
				$("#weightresult").html("På BK"+data.road+"-väg med totalt axelavstånd "+data.totalAxleDistance+" meter så är bruttomaxvikten "+result+" ton.");
			});
			$("#axleform").submit(function(e){
				e.preventDefault();
				var form = _.reduce($(this).serializeArray(),function(memo,val,key){ memo[val.name] = val.value; return memo;},{});
					data = {road:+form.road,axles:+form.type,axleWidth:+form.distance.replace(/\,/,"."),hasGoodSuspension: !!form.susp, isPropulsionAxle: !!form.prop},
					list = rolast.lists.axleLimits,
					result = rolast.lookUpInList(list,data);
					
				console.log(form,data,result);
			});
		</script>
	</body>
</html>